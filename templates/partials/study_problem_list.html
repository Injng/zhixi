{% for problem in problems %}
<div class="glass-panel p-6 rounded-lg border-l-4 border-l-industrial-500">
    <div class="flex justify-between items-start mb-4">
        <div class="flex items-center gap-2">
            <span class="text-xs font-bold uppercase tracking-wider text-industrial-400">
                {% if problem.source_kind == "Lecture" %}讲座
                {% else if problem.source_kind == "Discussion" %}讨论
                {% else if problem.source_kind == "Lab" %}实验
                {% else if problem.source_kind == "Homework" %}作业
                {% else if problem.source_kind == "Midterm" %}期中
                {% else if problem.source_kind == "Quiz" %}测验
                {% else if problem.source_kind == "Exam" %}考卷
                {% else %}其他{% endif %}
                • {{ problem.source_title }}
            </span>
            {% if problem.is_incorrect %}
            <span class="text-[10px] px-1.5 py-0.5 bg-red-900/50 text-red-400 rounded border border-red-800 font-bold uppercase tracking-wider">错题</span>
            {% endif %}
        </div>
        {% if let Some(cats) = problem.category_names %}
        <div class="flex gap-2">
            {% for cat in cats.split(',') %}
            <span class="text-xs px-2 py-1 bg-industrial-700 text-industrial-200 rounded font-medium">{{ cat }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    {% if let Some(url) = problem.image_url %}
    <div class="mb-4">
        <img src="{{ url }}" alt="Problem Screenshot"
            class="rounded-lg border border-industrial-700 max-h-96 object-contain bg-black/20">
    </div>
    {% endif %}

    <div class="flex justify-between items-end">
        <div class="flex-1">
            {% if let Some(notes) = problem.notes %}
            <div class="p-4 bg-industrial-900/50 rounded border border-industrial-800">
                <p class="text-sm text-industrial-300 font-mono">{{ notes }}</p>
            </div>
            {% endif %}
        </div>

        {% if let Some(link) = problem.solution_link %}
        {% if !link.is_empty() %}
        <div class="ml-4">
            <a href="{{ link }}" target="_blank"
                class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded transition-colors">
                查看解答
            </a>
        </div>
        {% endif %}
        {% endif %}
    </div>
</div>
{% endfor %}
